---
phase: 04-blazor-ui-with-static-display
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/OpenAnima.Core/Components/Layout/MainLayout.razor
  - src/OpenAnima.Core/Components/Layout/MainLayout.razor.css
  - src/OpenAnima.Core/Components/Pages/Dashboard.razor
  - src/OpenAnima.Core/Components/Pages/Dashboard.razor.css
  - src/OpenAnima.Core/Components/_Imports.razor
  - src/OpenAnima.Core/wwwroot/css/app.css
autonomous: true
requirements:
  - UI-01

must_haves:
  truths:
    - "Sidebar shows three navigation items: Dashboard, Modules, Heartbeat"
    - "Active navigation item is highlighted for the current page"
    - "Dashboard page shows numeric summary cards (module count, heartbeat state, tick count)"
    - "Sidebar collapses to hamburger menu on narrow screens (~768px)"
    - "Layout adapts to different screen sizes"
  artifacts:
    - path: "src/OpenAnima.Core/Components/Layout/MainLayout.razor"
      provides: "Three-item NavLink navigation with mobile hamburger toggle"
      contains: "NavLink"
    - path: "src/OpenAnima.Core/Components/Layout/MainLayout.razor.css"
      provides: "Responsive sidebar with @media 768px breakpoint"
      contains: "@media"
    - path: "src/OpenAnima.Core/Components/Pages/Dashboard.razor"
      provides: "Summary card overview with module count, heartbeat state, tick count"
      contains: "summary"
    - path: "src/OpenAnima.Core/wwwroot/css/app.css"
      provides: "Global responsive utility styles"
  key_links:
    - from: "MainLayout.razor"
      to: "NavLink component"
      via: "Blazor NavLink with Match parameter"
      pattern: "NavLink.*href"
    - from: "MainLayout.razor"
      to: "Dashboard/Modules/Heartbeat pages"
      via: "href routing"
      pattern: "href=\"/(modules|heartbeat)?\""
---

<objective>
Expand the navigation sidebar to three pages, refactor Dashboard to summary cards, and implement responsive layout with mobile sidebar collapse.

Purpose: Establishes the three-page navigation structure and responsive foundation that all subsequent UI work builds on. Converts the existing detailed Dashboard into a concise overview with summary cards per user decision.

Output: Updated MainLayout with NavLink navigation for Dashboard/Modules/Heartbeat, refactored Dashboard with summary cards, responsive sidebar with hamburger menu at 768px breakpoint.
</objective>

<execution_context>
@/home/user/.claude/get-shit-done/workflows/execute-plan.md
@/home/user/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-blazor-ui-with-static-display/04-CONTEXT.md
@.planning/phases/04-blazor-ui-with-static-display/04-RESEARCH.md
@src/OpenAnima.Core/Components/Layout/MainLayout.razor
@src/OpenAnima.Core/Components/Layout/MainLayout.razor.css
@src/OpenAnima.Core/Components/Pages/Dashboard.razor
@src/OpenAnima.Core/Components/Pages/Dashboard.razor.css
@src/OpenAnima.Core/Components/_Imports.razor
@src/OpenAnima.Core/wwwroot/css/app.css
@src/OpenAnima.Core/Services/IModuleService.cs
@src/OpenAnima.Core/Services/IHeartbeatService.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand navigation and add responsive sidebar</name>
  <files>
    src/OpenAnima.Core/Components/Layout/MainLayout.razor
    src/OpenAnima.Core/Components/Layout/MainLayout.razor.css
    src/OpenAnima.Core/Components/_Imports.razor
    src/OpenAnima.Core/wwwroot/css/app.css
  </files>
  <action>
Update MainLayout.razor to replace the hardcoded `<a>` nav item with three Blazor `NavLink` components:
- Dashboard: `href="/"` with `Match="NavLinkMatch.All"` (exact match to prevent root always highlighting)
- Modules: `href="/modules"` (default prefix match)
- Heartbeat: `href="/heartbeat"` (default prefix match)

Each NavLink uses `class="nav-item"` — NavLink automatically appends "active" class. Use Unicode icons: &#x25A3; for Dashboard, &#x25A8; for Modules, &#x25C9; for Heartbeat. Keep the existing collapsed sidebar behavior (hide nav-label when collapsed).

Add mobile responsive behavior:
- Add a `bool MobileMenuOpen` state field
- Add a hamburger button (&#x2630; character) inside `<main>` that only shows on mobile (controlled by CSS)
- When hamburger clicked, toggle `MobileMenuOpen` which adds/removes "mobile-open" class on sidebar
- Add a `.sidebar-overlay` div that shows when mobile menu is open, clicking it closes the menu

Update MainLayout.razor.css:
- Add `@media (max-width: 768px)` breakpoint
- Mobile: sidebar gets `position: fixed; left: 0; top: 0; height: 100vh; z-index: 1000; transform: translateX(-100%); transition: transform 0.3s ease;`
- `.sidebar.mobile-open` gets `transform: translateX(0);`
- `.sidebar-overlay` gets `position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 999;`
- `.hamburger-btn` styled as a button in the top-left of main content, only visible at mobile breakpoint (hidden by default, `display: block` at max-width 768px)
- Main content removes left padding on mobile to use full width

Update _Imports.razor to add `@using Microsoft.AspNetCore.Components.Routing` if not already present (needed for NavLinkMatch enum — verify it's already there from Phase 3).

In app.css, add no new global styles needed — all responsive styles go in scoped MainLayout.razor.css.
  </action>
  <verify>
Run `dotnet build src/OpenAnima.Core/` — must compile without errors. Visually inspect MainLayout.razor to confirm three NavLink elements with correct href and Match attributes. Confirm @media query exists in MainLayout.razor.css at 768px breakpoint.
  </verify>
  <done>
Three NavLink navigation items render in sidebar. Active page is highlighted via NavLink's automatic "active" class. Sidebar collapses to off-screen on narrow viewports with hamburger toggle and overlay.
  </done>
</task>

<task type="auto">
  <name>Task 2: Refactor Dashboard to summary cards</name>
  <files>
    src/OpenAnima.Core/Components/Pages/Dashboard.razor
    src/OpenAnima.Core/Components/Pages/Dashboard.razor.css
  </files>
  <action>
Refactor Dashboard.razor from the current detailed card layout to a concise summary card overview per user decision: "Dashboard overview shows numeric summary cards (module count, heartbeat state, tick count)."

Replace the current two detailed cards (Heartbeat with stats, Modules with list) with three summary cards in a grid:

1. **Modules card**: Icon (&#x25A8;), label "Modules", large numeric value `@ModuleService.Count`
2. **Heartbeat card**: Icon (&#x25C9;), label "Heartbeat", value showing "Running" (green) or "Stopped" (red) with status-indicator styling
3. **Ticks card**: Icon (&#x29D7;), label "Ticks", large numeric value `@HeartbeatService.TickCount` with mono font

Each summary card structure:
```razor
<div class="summary-card">
    <span class="summary-icon">[icon]</span>
    <div class="summary-content">
        <span class="summary-label">[label]</span>
        <span class="summary-value [extra-class]">[value]</span>
    </div>
</div>
```

Keep the existing `@page "/"`, `@inject IModuleService`, `@inject IHeartbeatService` directives.

Update Dashboard.razor.css:
- Replace existing styles with summary card styles
- `.summary-grid`: CSS Grid with `repeat(auto-fit, minmax(200px, 1fr))` and `gap: 20px`
- `.summary-card`: Uses `.card` base from app.css, `display: flex; align-items: center; gap: 16px;`
- `.summary-icon`: `font-size: 1.5rem; color: var(--accent-color);`
- `.summary-label`: `font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em;`
- `.summary-value`: `font-size: 1.5rem; font-weight: 600; color: var(--text-primary);`
- Keep `.status-indicator.running` and `.status-indicator.stopped` styles for heartbeat value
- Add `@media (max-width: 768px)` to force single column: `grid-template-columns: 1fr;`
- Keep `.page-title` style as-is
  </action>
  <verify>
Run `dotnet build src/OpenAnima.Core/` — must compile without errors. Verify Dashboard.razor contains three summary cards with ModuleService.Count, HeartbeatService.IsRunning, and HeartbeatService.TickCount. Verify CSS grid uses auto-fit with mobile fallback.
  </verify>
  <done>
Dashboard shows three numeric summary cards (module count, heartbeat state, tick count) in a responsive grid. Cards collapse to single column on mobile. Detailed module list and heartbeat stats removed from Dashboard (will be on dedicated pages in Plan 04-02).
  </done>
</task>

</tasks>

<verification>
1. `dotnet build src/OpenAnima.Core/` compiles without errors
2. MainLayout.razor contains three NavLink components with correct href values
3. Dashboard "/" route renders summary cards, not detailed lists
4. MainLayout.razor.css contains @media (max-width: 768px) responsive rules
5. NavLink for "/" uses Match="NavLinkMatch.All" to prevent always-active
</verification>

<success_criteria>
- Three-page navigation structure in sidebar with active state highlighting
- Dashboard refactored to concise summary cards
- Responsive layout with mobile sidebar collapse at 768px
- All existing functionality preserved (no regressions)
- Clean build with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-blazor-ui-with-static-display/04-01-SUMMARY.md`
</output>
